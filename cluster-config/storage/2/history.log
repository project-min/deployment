    1  yum install git -y
    2  mkdir /home/deployment
    3  cd /home/deployment
    4  git init
    5  git remote add origin https://github.com/project-min/deployment.git
    6  git pull origin master
    7  chmod 777 *.sh
    8  ./centos.sh
    9  mkdir /data
   10  mkdir /data/fastdfs
   11  mkdir /data/fastdfs/storage
   12  wget -P /opt https://github.com/happyfish100/libfastcommon/archive/V1.0.39.tar.gz
   13  tar -zxvf /opt/V1.0.39.tar.gz -C /opt
   14  cd /opt/libfastcommon-1.0.39
   15  /opt/libfastcommon-1.0.39/make.sh
   16  /opt/libfastcommon-1.0.39/make.sh install
   17  cd /
   18  wget -P /opt https://github.com/happyfish100/fastdfs/archive/V5.11.tar.gz
   19  tar -zxvf /opt/V5.11.tar.gz -C /opt
   20  cd /opt/fastdfs-5.11
   21  /opt/fastdfs-5.11/make.sh
   22  /opt/fastdfs-5.11/make.sh install
   23  cd /
   24  ln -s /usr/bin/stop.sh /usr/local/bin
   25  ln -s /usr/bin/restart.sh /usr/local/bin
   26  ln -s /usr/bin/fdfs_storaged /usr/local/bin
   27  systemctl start firewalld
   28  firewall-cmd --zone=public --add-port=8080/tcp --permanent
   29  firewall-cmd --zone=public --add-port=23000/tcp --permanent
   30  firewall-cmd --reload
   31  fdfs_storaged /etc/fdfs/storage.conf restart
   32  cp /home/deployment/cluster-config/storage/storage.conf /etc/fdfs/
   33  fdfs_storaged /etc/fdfs/storage.conf restart
   34  netstat -unltp | grep fdfs
   35  ln -s /data/fastdfs/storage/data/ /data/fastdfs/storage/data/M00
   36  fdfs_monitor /etc/fdfs/storage.conf
   37  cd /data/fastdfs/storage/data/
   38  ls
   39  cd 00
   40  los
   41  ls
   42  wget -P /opt https://github.com/happyfish100/fastdfs-nginx-module/archive/master.zip
   43  unzip /opt/master.zip -d /opt
   44  sed -i '6s/\/usr\/local\/include/\/usr\/include\/fastdfs \/usr\/include\/fastcommon\//g' /opt/fastdfs-nginx-module-master/src/config
   45  sed -i '15s/\/usr\/local\/include/\/usr\/include\/fastdfs \/usr\/include\/fastcommon\//g' /opt/fastdfs-nginx-module-master/src/config
   46  wget -P /opt -c https://nginx.org/download/nginx-1.14.1.tar.gz
   47  tar xvf /opt/nginx-1.14.1.tar.gz -C /opt
   48  cd /opt/nginx-1.14.1
   49  ./configure --add-module=/opt/fastdfs-nginx-module-master/src
   50  make
   51  make install
   52  cp /home/deployment/cluster-config/storage/mod_fastdfs.conf /etc/fdfs/
   53  cp /home/deployment/cluster-config/storage/nginx.conf /usr/local/nginx/conf/
   54  fdfs_storaged /etc/fdfs/storage.conf restart
   55  netstat -unltp | grep fdfs
   56  ln -s /data/fastdfs/storage/data/ /data/fastdfs/storage/data/M00
   57  /usr/local/nginx/sbin/nginx
   58  cd /data/fastdfs/storage/data/00/00/
   59  ls
   60  vim /etc/fdfs/storage.conf
   61  vim /etc/fdfs/mod_fastdfs.conf
   62  /usr/local/bin/stop.sh /opt/FastDFS/conf/storage.conf
   63  fdfs_storaged /etc/fdfs/storage.conf restart
   64  /usr/local/nginx/sbin/nginx -s stop
   65  /usr/local/nginx/sbin/nginx
   66  fdfs_monitor /etc/fdfs/storage.conf
   67  ls
   68  firewall-cmd --list-ports
   69  cp /opt/fastdfs-5.11/conf/http.conf /etc/fdfs/
   70  cp /opt/fastdfs-5.11/conf/mime.types /etc/fdfs/
   71  /usr/local/nginx/sbin/nginx -s stop
   72  /usr/local/nginx/sbin/nginx
   73  ls
   74  reboot now
   75  fdfs_storaged /etc/fdfs/storage.conf restart
   76  /usr/local/nginx/sbin/nginx
   77  git config --global user.email "project.min@outlook.com"
   78  git config --global user.name "Ye Min"
   79  cd /home/deployment/cluster-config/
   80  ls
   81  cd storage/
   82  ls
   83  git pull origin master
   84  ls
   85  mkdir 2
   86  cd 2
   87  cp /etc/fdfs/storage.conf ./
   88  ls
   89  cp /etc/fdfs/mod_fastdfs.conf ./
   90  ls
   91  cp /usr/local/nginx/conf/nginx.conf ./
   92  ls
   93  history >> history.log
